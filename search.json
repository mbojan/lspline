[{"path":"https://mbojan.github.io/lspline/articles/lspline.html","id":"generate-example-data","dir":"Articles","previous_headings":"","what":"Generate example data","title":"Fitting linear splines","text":"use following artificial data knots x=5 x=10 Plotting y x:  slopes consecutive segments 2, -3, 0.","code":"set.seed(666) n <- 200 d <- data.frame(   x = scales::rescale(rchisq(n, 6), c(0, 20)) ) d$interval <- findInterval(d$x, c(5, 10), rightmost.closed = TRUE) + 1 d$slope <- c(2, -3, 0)[d$interval] d$intercept <- c(0, 25, -5)[d$interval] d$y <- with(d, intercept + slope * x + rnorm(n, 0, 1)) library(ggplot2) fig <- ggplot(d, aes(x=x, y=y)) +    geom_point(aes(color=as.character(slope))) +   scale_color_discrete(name=\"Slope\") +   theme_bw() fig"},{"path":"https://mbojan.github.io/lspline/articles/lspline.html","id":"setting-knot-locations-manually","dir":"Articles","previous_headings":"","what":"Setting knot locations manually","title":"Fitting linear splines","text":"can parametrize spline slopes individual segments (default marginal=FALSE): parametrize coeficients measuring change slope (marginal=TRUE): coefficients lspline(x, c(5, 10), marginal = TRUE)1 - slope first segment lspline(x, c(5, 10), marginal = TRUE)2 - change slope knot \\(x=5\\); changing 2 -3, -5 lspline(x, c(5, 10), marginal = TRUE)3 - tha change slope knot \\(x=10\\); changing -3 0, 3 two parametrisations (obviously) give identical predicted values: graphically","code":"library(lspline) m1 <- lm(y ~ lspline(x, c(5, 10)), data=d) knitr::kable(broom::tidy(m1)) m2 <- lm(y ~ lspline(x, c(5,10), marginal=TRUE), data=d) knitr::kable(broom::tidy(m2)) all.equal( fitted(m1), fitted(m2) ) ## [1] TRUE fig +   geom_smooth(method=\"lm\", formula=formula(m1), se=FALSE, color = \"black\") +   geom_vline(xintercept = c(5, 10), linetype=2)"},{"path":"https://mbojan.github.io/lspline/articles/lspline.html","id":"knots-at-n-equal-length-intervals","dir":"Articles","previous_headings":"","what":"Knots at n equal-length intervals","title":"Fitting linear splines","text":"Function elspline() sets knots points dividing range x n equal length intervals. Graphically","code":"m3 <- lm(y ~ elspline(x, 3), data=d) knitr::kable(broom::tidy(m3)) fig +   geom_smooth(method=\"lm\", formula=formula(m3), se=FALSE, n=200,               color = \"black\")"},{"path":"https://mbojan.github.io/lspline/articles/lspline.html","id":"knots-at-quantiles-of-x","dir":"Articles","previous_headings":"","what":"Knots at quantiles of x","title":"Fitting linear splines","text":"Function qlspline() sets knots points dividing range x q equal-frequency intervals. Graphically","code":"m4 <- lm(y ~ qlspline(x, 4), data=d) knitr::kable(broom::tidy(m4)) fig +   geom_smooth(method=\"lm\", formula=formula(m4), se=FALSE, n=200,                color = \"black\")"},{"path":"https://mbojan.github.io/lspline/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Michal Bojanowski. Author, maintainer.","code":""},{"path":"https://mbojan.github.io/lspline/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Bojanowski M (2022). lspline: Linear Splines Convenient Parametrisations. R package version 1.0-1, https://mbojan.github.io/lspline/.","code":"@Manual{,   title = {lspline: Linear Splines with Convenient Parametrisations},   author = {Michal Bojanowski},   year = {2022},   note = {R package version 1.0-1},   url = {https://mbojan.github.io/lspline/}, }"},{"path":"https://mbojan.github.io/lspline/index.html","id":"lspline-linear-splines-with-convenient-parameterizations","dir":"","previous_headings":"","what":"Linear Splines with Convenient Parametrisations","title":"Linear Splines with Convenient Parametrisations","text":"Linear splines convenient parameterizations : coefficients slopes consecutive segments coefficients capture slope change consecutive knots Knot locations can specified manually (lspline()) breaks dividing range x q equal-frequency intervals (qlspline()) breaks dividing range x n equal-width intervals (elspline()) Inspired Stata command mkspline function lspline() package ares (Junger Ponce de Leon 2011). , implementation follows Greene (2003), chapter 7.5.2.","code":""},{"path":"https://mbojan.github.io/lspline/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Linear Splines with Convenient Parametrisations","text":"CRAN development version using remotes:","code":"remotes::install_github(\"mbojan/lspline\", build_vignettes = TRUE)"},{"path":"https://mbojan.github.io/lspline/index.html","id":"examples","dir":"","previous_headings":"","what":"Examples","title":"Linear Splines with Convenient Parametrisations","text":"See package homepage vignette.","code":""},{"path":[]},{"path":"https://mbojan.github.io/lspline/reference/lspline.html","id":null,"dir":"Reference","previous_headings":"","what":"Basis for a piecewise linear spline with meaningful coefficients — lspline","title":"Basis for a piecewise linear spline with meaningful coefficients — lspline","text":"functions compute basis piecewise-linear spline , depending argument marginal, coefficients can interpreted (1) slopes consecutive spline segments, (2) slope change consecutive knots.","code":""},{"path":"https://mbojan.github.io/lspline/reference/lspline.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Basis for a piecewise linear spline with meaningful coefficients — lspline","text":"","code":"lspline(x, knots = NULL, marginal = FALSE, names = NULL)  qlspline(x, q, na.rm = FALSE, ...)  elspline(x, n, ...)"},{"path":"https://mbojan.github.io/lspline/reference/lspline.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Basis for a piecewise linear spline with meaningful coefficients — lspline","text":"x numeric vector, variable knots numeric vector knot positions marginal logical, parametrize spline, see Details names character, vector names constructed variables q numeric, single scalar greater equal 2 number equal-frequency intervals along x vector numbers (0; 1) specifying quantiles explicitely. na.rm logical, whether NA removed calculating quantiles, passed na.rm quantile. ... arguments passed lspline n integer greater 2, knots computed cut n equally-spaced intervals along range x","code":""},{"path":"https://mbojan.github.io/lspline/reference/lspline.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Basis for a piecewise linear spline with meaningful coefficients — lspline","text":"marginal FALSE (default) coefficients spline correspond slopes consecutive segments. TRUE first coefficient correspond slope first segment. consecutive coefficients correspond change slope compared previous segment. Function qlspline wraps lspline calculates knot positions quantiles x. q numerical scalar greater equal 2, quantiles computed seq(0, 1, length.= q + 1)[-c(1, q+1)], .e. knots q-tiles distribution x. Alternatively, q can vector values [0; 1] specifying quantile probabilities directly (vector passed argument probs quantile). Function elspline wraps lspline computes knot positions cut range x n equal-width intervals.","code":""},{"path":"https://mbojan.github.io/lspline/reference/lspline.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Basis for a piecewise linear spline with meaningful coefficients — lspline","text":"Poirier, Dale J., Steven G. Garber. (1974) \"Determinants Aerospace Profit Rates 1951-1971.\" Southern Economic Journal: 228-238. Greene, William H. (2003) Econometric analysis. Pearson Education Junger & Ponce de Leon (2011) \"ares: Environment air pollution epidemiology: library timeseries analysis\". R package version 0.7.2 retrieved CRAN archives.","code":""},{"path":[]},{"path":"https://mbojan.github.io/lspline/reference/lspline.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Basis for a piecewise linear spline with meaningful coefficients — lspline","text":"function inspired Stata command mkspline function ares::lspline Junger & Ponce de Leon (2011). , implementation follows Greene (2003), chapter 7.2.5","code":""},{"path":"https://mbojan.github.io/lspline/reference/lspline.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Basis for a piecewise linear spline with meaningful coefficients — lspline","text":"","code":"# Data from a quadratic polynomial set.seed(666) x <- rnorm(100, 5, 2) y <- (x-5)^2 + rnorm(100) plot(x, y)  # -- Marginal and non-marginal parametrisations m.nonmarginal <- lm(y ~ lspline(x, 5)) m.marginal <- lm(y ~ lspline(x, 5, marginal=TRUE)) # Slope of consecutive segments coef(m.nonmarginal) #>    (Intercept) lspline(x, 5)1 lspline(x, 5)2  #>      18.125666      -4.211405       4.318447  # Slope change and consecutive knots coef(m.marginal) #>                     (Intercept) lspline(x, 5, marginal = TRUE)1  #>                       18.125666                       -4.211405  #> lspline(x, 5, marginal = TRUE)2  #>                        8.529853  # Identical predicted values identical( fitted(m.nonmarginal), fitted(m.marginal)) #> [1] FALSE   # -- Different ways to place knots # Manually: knots at x=4 and x=6 m1 <- lm(y ~ lspline(x, c(4, 6))) # 2 knots at terciles of 'x' m2 <- lm(y ~ qlspline(x, 3)) # 3 knots dividing range of 'x' into 4 equal-width intervals m3 <- lm(y ~ elspline(x, 4))  # Graphically ox <- seq(min(x), max(x), length=100) lines(ox, predict(m1, data.frame(x=ox)), col=\"red\") lines(ox, predict(m2, data.frame(x=ox)), col=\"blue\") lines(ox, predict(m3, data.frame(x=ox)), col=\"green\") legend(\"topright\",   legend=c(\"m1: lspline\", \"m2: qlspline\", \"m3: elspline\"),   col=c(\"red\", \"blue\", \"green\"),   bty=\"n\", lty=1)"},{"path":"https://mbojan.github.io/lspline/news/index.html","id":"lspline-10-1","dir":"Changelog","previous_headings":"","what":"lspline 1.0-1","title":"lspline 1.0-1","text":"Added NEWS.md file track changes package.","code":""},{"path":"https://mbojan.github.io/lspline/news/index.html","id":"lspline-10-0","dir":"Changelog","previous_headings":"","what":"lspline 1.0-0","title":"lspline 1.0-0","text":"CRAN release: 2017-04-10 First release CRAN","code":""}]
