<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Linear splines with convenient parametrisations such that 
  (1) coefficients are slopes of consecutive segments or (2) coefficients are 
  slope changes at consecutive knots. Knots can be set manually or at break points
  of equal-frequency or equal-width intervals covering the range of x.
  The implementation follows Greene (2003), chapter 7.2.5.">
<title>Linear Splines with Convenient Parametrisations • lspline</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Linear Splines with Convenient Parametrisations">
<meta property="og:description" content="Linear splines with convenient parametrisations such that 
  (1) coefficients are slopes of consecutive segments or (2) coefficients are 
  slope changes at consecutive knots. Knots can be set manually or at break points
  of equal-frequency or equal-width intervals covering the range of x.
  The implementation follows Greene (2003), chapter 7.2.5.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">lspline</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0-1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="articles/lspline.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="lspline-linear-splines-with-convenient-parametrisations">
<code>lspline</code>: Linear Splines with Convenient Parametrisations<a class="anchor" aria-label="anchor" href="#lspline-linear-splines-with-convenient-parametrisations"></a>
</h1></div>
<ul>
<li>
<a href="#examples" id="toc-examples">Examples</a>
<ul>
<li><a href="#setting-knot-locations-manually" id="toc-setting-knot-locations-manually">Setting knot locations manually</a></li>
<li><a href="#knots-at-n-equal-length-intervals" id="toc-knots-at-n-equal-length-intervals">Knots at <code>n</code> equal-length intervals</a></li>
<li><a href="#knots-at-quantiles-of-x" id="toc-knots-at-quantiles-of-x">Knots at <code>q</code>uantiles of <code>x</code></a></li>
</ul>
</li>
<li><a href="#installation" id="toc-installation">Installation</a></li>
<li><a href="#acknowledgements" id="toc-acknowledgements">Acknowledgements</a></li>
</ul>
<!-- badges: start -->
<p>Linear splines with convenient parametrisations such that</p>
<ul>
<li>coefficients are slopes of consecutive segments</li>
<li>coefficients capture slope change at consecutive knots</li>
</ul>
<p>Knot locations can be specified</p>
<ul>
<li>manually (<code><a href="reference/lspline.html">lspline()</a></code>)</li>
<li>at breaks dividing the range of <code>x</code> into <code>q</code> equal-frequency intervals (<code><a href="reference/lspline.html">qlspline()</a></code>)</li>
<li>at breaks dividing the range of <code>x</code> into <code>n</code> equal-width intervals (<code><a href="reference/lspline.html">elspline()</a></code>)</li>
</ul>
</div>
<div class="section level1">
<h1 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h1>
<p>Examples of using <code><a href="reference/lspline.html">lspline()</a></code>, <code><a href="reference/lspline.html">qlspline()</a></code>, and <code><a href="reference/lspline.html">elspline()</a></code>. We will use the following artificial data with knots at <code>x=5</code> and <code>x=10</code></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">666</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/rescale.html" class="external-link">rescale</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html" class="external-link">rchisq</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">6</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">d</span><span class="op">$</span><span class="va">interval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/findInterval.html" class="external-link">findInterval</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span>, rightmost.closed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span></span>
<span><span class="va">d</span><span class="op">$</span><span class="va">slope</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="op">-</span><span class="fl">3</span>, <span class="fl">0</span><span class="op">)</span><span class="op">[</span><span class="va">d</span><span class="op">$</span><span class="va">interval</span><span class="op">]</span></span>
<span><span class="va">d</span><span class="op">$</span><span class="va">intercept</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">25</span>, <span class="op">-</span><span class="fl">5</span><span class="op">)</span><span class="op">[</span><span class="va">d</span><span class="op">$</span><span class="va">interval</span><span class="op">]</span></span>
<span><span class="va">d</span><span class="op">$</span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">intercept</span> <span class="op">+</span> <span class="va">slope</span> <span class="op">*</span> <span class="va">x</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Plotting <code>y</code> against <code>x</code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="va">fig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">d</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>shape<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">slope</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_shape.html" class="external-link">scale_shape_discrete</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Slope"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">fig</span></span></code></pre></div>
<p><img src="tools/lspline-show_data-1.png"><!-- --></p>
<p>The slopes of the consecutive segments are 2, -3, and 0.</p>
<div class="section level2">
<h2 id="setting-knot-locations-manually">Setting knot locations manually<a class="anchor" aria-label="anchor" href="#setting-knot-locations-manually"></a>
</h2>
<p>We can parametrize the spline with slopes of individual segments (default <code>marginal=FALSE</code>):</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mbojan.github.io/lspline/">lspline</a></span><span class="op">)</span></span>
<span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fu"><a href="reference/lspline.html">lspline</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span>, data<span class="op">=</span><span class="va">d</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="32%">
<col width="17%">
<col width="15%">
<col width="18%">
<col width="15%">
</colgroup>
<thead><tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">0.1343204</td>
<td align="right">0.2148116</td>
<td align="right">0.6252941</td>
<td align="right">0.5325054</td>
</tr>
<tr class="even">
<td align="left">lspline(x, c(5, 10))1</td>
<td align="right">1.9435458</td>
<td align="right">0.0597698</td>
<td align="right">32.5171747</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left">lspline(x, c(5, 10))2</td>
<td align="right">-2.9666750</td>
<td align="right">0.0503967</td>
<td align="right">-58.8664832</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">lspline(x, c(5, 10))3</td>
<td align="right">-0.0335289</td>
<td align="right">0.0518601</td>
<td align="right">-0.6465255</td>
<td align="right">0.5186955</td>
</tr>
</tbody>
</table>
<p>Or parametrize with coeficients measuring change in slope (with <code>marginal=TRUE</code>):</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fu"><a href="reference/lspline.html">lspline</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">10</span><span class="op">)</span>, marginal<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>, data<span class="op">=</span><span class="va">d</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">m2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="45%">
<col width="13%">
<col width="12%">
<col width="14%">
<col width="12%">
</colgroup>
<thead><tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">0.1343204</td>
<td align="right">0.2148116</td>
<td align="right">0.6252941</td>
<td align="right">0.5325054</td>
</tr>
<tr class="even">
<td align="left">lspline(x, c(5, 10), marginal = TRUE)1</td>
<td align="right">1.9435458</td>
<td align="right">0.0597698</td>
<td align="right">32.5171747</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left">lspline(x, c(5, 10), marginal = TRUE)2</td>
<td align="right">-4.9102208</td>
<td align="right">0.0975908</td>
<td align="right">-50.3143597</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">lspline(x, c(5, 10), marginal = TRUE)3</td>
<td align="right">2.9331462</td>
<td align="right">0.0885445</td>
<td align="right">33.1262479</td>
<td align="right">0.0000000</td>
</tr>
</tbody>
</table>
<p>The coefficients are</p>
<ul>
<li>
<code>lspline(x, c(5, 10), marginal = TRUE)1</code> - the slope of the first segment</li>
<li>
<code>lspline(x, c(5, 10), marginal = TRUE)2</code> - the change in slope at knot <span class="math inline"><em>x</em> = 5</span>; it is changing from 2 to -3, so by -5</li>
<li>
<code>lspline(x, c(5, 10), marginal = TRUE)3</code> - tha change in slope at knot <span class="math inline"><em>x</em> = 10</span>; it is changing from -3 to 0, so by 3</li>
</ul>
<p>The two parametrisations (obviously) give identical predicted values:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">m2</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="co">## [1] TRUE</span></span></code></pre></div>
<p>graphically</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fig</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">"lm"</span>, formula<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span>, se<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span>, linetype<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="tools/lspline-lspline_fitted-1.png"><!-- --></p>
</div>
<div class="section level2">
<h2 id="knots-at-n-equal-length-intervals">Knots at <code>n</code> equal-length intervals<a class="anchor" aria-label="anchor" href="#knots-at-n-equal-length-intervals"></a>
</h2>
<p>Function <code><a href="reference/lspline.html">elspline()</a></code> sets the knots at points dividing the range of <code>x</code> into <code>n</code> equal length intervals.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fu"><a href="reference/lspline.html">elspline</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">3</span><span class="op">)</span>, data<span class="op">=</span><span class="va">d</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">m3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">3.5484817</td>
<td align="right">0.4603827</td>
<td align="right">7.707678</td>
<td align="right">0.00e+00</td>
</tr>
<tr class="even">
<td align="left">elspline(x, 3)1</td>
<td align="right">0.4652507</td>
<td align="right">0.1010200</td>
<td align="right">4.605529</td>
<td align="right">7.40e-06</td>
</tr>
<tr class="odd">
<td align="left">elspline(x, 3)2</td>
<td align="right">-2.4908385</td>
<td align="right">0.1167867</td>
<td align="right">-21.328105</td>
<td align="right">0.00e+00</td>
</tr>
<tr class="even">
<td align="left">elspline(x, 3)3</td>
<td align="right">0.9475630</td>
<td align="right">0.2328691</td>
<td align="right">4.069080</td>
<td align="right">6.84e-05</td>
</tr>
</tbody>
</table>
<p>Graphically</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fig</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>group<span class="op">=</span><span class="fl">1</span><span class="op">)</span>, method<span class="op">=</span><span class="st">"lm"</span>, formula<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></span><span class="op">(</span><span class="va">m3</span><span class="op">)</span>, se<span class="op">=</span><span class="cn">FALSE</span>, n<span class="op">=</span><span class="fl">200</span><span class="op">)</span></span></code></pre></div>
<p><img src="tools/lspline-elspline-fitted-1.png"><!-- --></p>
</div>
<div class="section level2">
<h2 id="knots-at-quantiles-of-x">Knots at <code>q</code>uantiles of <code>x</code>
<a class="anchor" aria-label="anchor" href="#knots-at-quantiles-of-x"></a>
</h2>
<p>Function <code><a href="reference/lspline.html">qlspline()</a></code> sets the knots at points dividing the range of <code>x</code> into <code>q</code> equal-frequency intervals.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fu"><a href="reference/lspline.html">qlspline</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">4</span><span class="op">)</span>, data<span class="op">=</span><span class="va">d</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">m4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">0.0782285</td>
<td align="right">0.3948061</td>
<td align="right">0.198144</td>
<td align="right">0.8431388</td>
</tr>
<tr class="even">
<td align="left">qlspline(x, 4)1</td>
<td align="right">2.0398804</td>
<td align="right">0.1802724</td>
<td align="right">11.315548</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left">qlspline(x, 4)2</td>
<td align="right">1.2675186</td>
<td align="right">0.1471270</td>
<td align="right">8.615132</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">qlspline(x, 4)3</td>
<td align="right">-4.5846478</td>
<td align="right">0.1476810</td>
<td align="right">-31.044273</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left">qlspline(x, 4)4</td>
<td align="right">-0.4965858</td>
<td align="right">0.0572115</td>
<td align="right">-8.679818</td>
<td align="right">0.0000000</td>
</tr>
</tbody>
</table>
<p>Graphically</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fig</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">"lm"</span>, formula<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></span><span class="op">(</span><span class="va">m4</span><span class="op">)</span>, se<span class="op">=</span><span class="cn">FALSE</span>, n<span class="op">=</span><span class="fl">200</span><span class="op">)</span></span></code></pre></div>
<p><img src="tools/lspline-qlspline-fitted-1.png"><!-- --></p>
</div>
</div>
<div class="section level1">
<h1 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h1>
<p>Stable version from CRAN or development version from GitHub with</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"mbojan/lspline"</span>, build_vignettes<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level1">
<h1 id="acknowledgements">Acknowledgements<a class="anchor" aria-label="anchor" href="#acknowledgements"></a>
</h1>
<p>Inspired by Stata command <code>mkspline</code> and function <code>ares::lspline</code> from Junger &amp; Ponce de Leon (2011). As such, the implementation follows Greene (2003), chapter 7.5.2.</p>
<ul>
<li>Greene, William H. (2003) <em>Econometric analysis</em>. Pearson Education</li>
<li>Junger &amp; Ponce de Leon (2011) <em><code>ares</code>: Environment air pollution epidemiology: a library for timeseries analysis</em>. R package version 0.7.2 retrieved from CRAN archives.</li>
</ul>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=lspline" class="external-link">View on CRAN</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing lspline</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Michal Bojanowski <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-7503-852X" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/mbojan/lspline/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/mbojan/lspline/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="http://cranlogs.r-pkg.org/" class="external-link"><img src="http://cranlogs.r-pkg.org/badges/lspline?color=2ED968" alt="rstudio mirror downloads"></a></li>
<li><a href="https://cran.r-project.org/package=lspline" class="external-link"><img src="http://www.r-pkg.org/badges/version/lspline" alt="cran version"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Michal Bojanowski.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
